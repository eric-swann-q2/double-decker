{"version":3,"sources":["../src/logger.ts","../src/messages/category.ts","../src/messages/behavior.ts","../src/messages/message.ts","../src/emitter.ts","../src/store.ts","../src/push-id.ts","../src/messages/message-contract.ts","../src/message-factory.ts","../src/bus.ts","../src/player.ts","../src/hub.ts"],"names":["ConsoleLogger","prototype","log","level","args","_i","arguments","length","console","debug","apply","error","this","warn","info","Category","Behavior","mustPlay","playable","Message","id","category","type","data","timestamp","behavior","Action","_super","behavior_1","call","category_1","__extends","Event","Emitter","_logger","_receiverStore","Map","_subscriberStore","Object","defineProperty","_lastAction","_lastEvent","addReceiver","receiver","lowerType","toLowerCase","existingReceiver","get","_throwError","set","removeReceiver","delete","getReceiver","emitAction","action","result","Promise","resolve","addSubscriber","subscriber","subscribers","Array","push","removeSubscriber","itemIndex","indexOf","splice","getSubscribers","emitEvent","event","_this","resultPromises","forEach","lastAction","actionId","errorMessage","Error","MemoryStore","actions","events","addAction","addEvent","clearActions","clearEvents","createId","now","Date","getTime","duplicateTime","lastPushTime","timeStampChars","i","PUSH_CHARS","charAt","Math","floor","join","j","lastRandChars","random","k","MessageContract","behavior_2","MessageFactory","CreateAction","actionContract","message_1","push_id_1","CreateEvent","eventContract","DataWithIdMessageFactory","idProperty","Bus","_messageFactory","_emitter","_store","lastEvent","receive","unreceive","send","emitResult","createAndSend","message_contract_1","subscribe","unsubscribe","publish","results","createAndPublish","Player","_headPosition","messages","message","_category","position","event_1","setHead","setHeadById","messageId","findIndex","msg","playNext","next","_playNext","play","clear","_clearMessages","ActionPlayer","logger","category_2","EventPlayer","all","Hub","bus","actionPlayer","eventPlayer"],"mappings":"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","file":"./dist/index.min.js","sourceRoot":""}